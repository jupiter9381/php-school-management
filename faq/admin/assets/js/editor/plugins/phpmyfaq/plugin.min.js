/*! phpMyFAQ v2.9.13 - https://www.phpmyfaq.de/ - Copyright (c) 2001 - 2019 Thorsten Rinne and phpMyFAQ Team */
/**
 * TinyMCE v4 plugin to fetch and insert internal links via Ajax call
 *
 * This Source Code Form is subject to the terms of the Mozilla Public License,
 * v. 2.0. If a copy of the MPL was not distributed with this file, You can
 * obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @category  phpMyFAQ
 * @package   Administration
 * @author    Thorsten Rinne <thorsten@phpmyfaq.de>
 * @copyright 2015-2019 phpMyFAQ Team
 * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
 * @link      https://www.phpmyfaq.de
 * @since     2015-10-08
 */
tinymce.PluginManager.add("phpmyfaq",function(a){"use strict";a.addButton("phpmyfaq",{image:"images/phpmyfaq.gif",onclick:function(){a.windowManager.open({title:"Internal links",width:480,height:320,body:[{type:"textbox",name:"search",label:"Search",id:"pmf-internal-links"},{type:"container",name:"pmf-faq-list",id:"pmf-faq-list",minHeight:240}],onkeyup:function(){var a=$("#pmf-internal-links").val(),b=location.protocol+"//"+location.host+location.pathname,c=top.tinymce.activeEditor.windowManager.getParams(),d=$("#pmf-faq-list");a.length>0&&$.ajax({type:"POST",url:b+"index.php?action=ajax&ajax=records&ajaxaction=search_records",data:"search="+a+"&csrf="+c.csrf,success:function(a){d.empty(),a.length>0&&d.append(a)}})},onsubmit:function(){var b=$("input:radio[name=faqURL]:checked"),c=b.val(),d=b.parent().text(),e='<a class="pmf-internal-link" href="'+c+'">'+d+"</a>";a.insertContent(e)}},{csrf:$("#csrf").val()})}})});